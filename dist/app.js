class a{allApps=[];fuse=null;currentFilter="all";currentQuery="";debounceTimer=null;searchInput;resultsContainer;loadingEl;emptyStateEl;resultsCountEl;totalCountEl;filterButtons;fuseOptions={keys:[{name:"name",weight:0.7},{name:"description",weight:0.3}],threshold:0.4,ignoreLocation:!0,minMatchCharLength:2};constructor(){this.searchInput=document.getElementById("search-input"),this.resultsContainer=document.getElementById("results"),this.loadingEl=document.getElementById("loading"),this.emptyStateEl=document.getElementById("empty-state"),this.resultsCountEl=document.getElementById("results-count"),this.totalCountEl=document.getElementById("total-count"),this.filterButtons=document.querySelectorAll(".filter-btn"),this.init()}async init(){try{let t=await(await fetch("data/apps.json")).json();this.allApps=t.apps,this.fuse=new window.Fuse(this.allApps,this.fuseOptions),this.totalCountEl.textContent=String(this.allApps.length),this.loadingEl.classList.add("hidden"),this.render(this.allApps),this.setupEventListeners()}catch(e){console.error("Failed to load apps:",e),this.loadingEl.textContent="Failed to load apps. Please refresh the page."}}setupEventListeners(){this.searchInput.addEventListener("input",(e)=>{if(this.debounceTimer)clearTimeout(this.debounceTimer);this.debounceTimer=setTimeout(()=>{this.currentQuery=e.target.value.trim(),this.updateResults()},150)}),this.filterButtons.forEach((e)=>{e.addEventListener("click",()=>{this.currentFilter=e.dataset.filter,this.updateFilterButtonStyles(),this.updateResults()})}),document.addEventListener("keydown",(e)=>{if(e.key==="/"&&document.activeElement!==this.searchInput)e.preventDefault(),this.searchInput.focus();if(e.key==="Escape")this.searchInput.blur()})}updateFilterButtonStyles(){this.filterButtons.forEach((e)=>{if(e.dataset.filter===this.currentFilter)e.className="filter-btn px-4 py-2 rounded-lg font-medium transition-colors bg-blue-600 text-white";else e.className="filter-btn px-4 py-2 rounded-lg font-medium transition-colors bg-gray-200 text-gray-700 hover:bg-gray-300"})}getFilteredApps(){let e=this.allApps;if(this.currentFilter!=="all")e=e.filter((t)=>t.pricing===this.currentFilter);if(this.currentQuery.length>=2&&this.fuse){let t=this.fuse.search(this.currentQuery),n=new Set(t.map((s)=>s.item.id));e=e.filter((s)=>n.has(s.id));let r=new Map(t.map((s,i)=>[s.item.id,i]));e.sort((s,i)=>(r.get(s.id)??999)-(r.get(i.id)??999))}return e}updateResults(){let e=this.getFilteredApps();this.render(e)}render(e){if(this.resultsCountEl.textContent=`Showing ${e.length} app${e.length!==1?"s":""}`,e.length===0){this.resultsContainer.innerHTML="",this.emptyStateEl.classList.remove("hidden");return}this.emptyStateEl.classList.add("hidden");let t=e.slice(0,100),n=e.length>100;this.resultsContainer.innerHTML=t.map((r)=>this.createAppCard(r)).join("")+(n?'<p class="text-center text-gray-500 py-4">Showing first 100 results. Refine your search to see more.</p>':"")}createAppCard(e){let t=e.pricing==="free"?'<span class="px-2 py-0.5 text-xs font-medium bg-green-100 text-green-800 rounded">FREE</span>':'<span class="px-2 py-0.5 text-xs font-medium bg-red-100 text-red-800 rounded">PAID</span>',n=e.isOpenSource?`<a href="${this.escapeHtml(e.repoUrl||e.url)}" target="_blank" rel="noopener" class="px-2 py-0.5 text-xs font-medium bg-blue-100 text-blue-800 rounded hover:bg-blue-200">OSS</a>`:"",r=e.isAppStore?`<a href="${this.escapeHtml(e.appStoreUrl||"#")}" target="_blank" rel="noopener" class="px-2 py-0.5 text-xs font-medium bg-purple-100 text-purple-800 rounded hover:bg-purple-200">App Store</a>`:"";return`
      <article class="bg-white rounded-lg border border-gray-200 p-4 hover:shadow-md transition-shadow">
        <div class="flex items-start justify-between gap-4">
          <div class="flex-1 min-w-0">
            <div class="flex items-center gap-2 flex-wrap mb-1">
              <a href="${this.escapeHtml(e.url)}"
                 target="_blank"
                 rel="noopener noreferrer"
                 class="font-semibold text-gray-900 hover:text-blue-600 truncate">
                ${this.escapeHtml(e.name)}
              </a>
              ${t}
              ${n}
              ${r}
            </div>
            <p class="text-sm text-gray-500 mb-2">${this.escapeHtml(e.category)}${e.subcategory!==e.category?" > "+this.escapeHtml(e.subcategory):""}</p>
            <p class="text-gray-600 text-sm line-clamp-2">${this.escapeHtml(e.description)}</p>
          </div>
        </div>
      </article>
    `}escapeHtml(e){let t=document.createElement("div");return t.textContent=e,t.innerHTML}}document.addEventListener("DOMContentLoaded",()=>{new a});
